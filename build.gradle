/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.0.1/userguide/tutorial_java_projects.html
 */

//import org.jetbrains.kotlin.gradle.tasks.KotlinCompile

plugins {
    id 'idea'

    // Apply the java plugin to add support for Java
    id 'java'
    id("org.jetbrains.kotlin.jvm") version "1.3.61"
    // Apply the application plugin to add support for building a CLI application.
    id 'application'
    // Apply the groovy plugin to also add support for Groovy (needed for Spock)
    id "io.freefair.lombok" version "4.1.6"
}

repositories {
    // You can declare any Maven/Ivy/file repository here.
    maven { url "https://maven.aliyun.com/repository/jcenter" }
    maven { url 'https://projectlombok.org/edge-releases' }
//    maven { url "https://plugins.gradle.org/m2/" }
//    jcenter()
}


lombok {
    version = "1.18.12"
    config['lombok.log.fieldName'] = 'LOG'
    generateLombokConfig.enabled = true
}


application {
    // Define the main class for the application.
    mainClassName = 'me.daqiang.MainKt'
}

sourceSets {
    main {
        java {
            srcDirs = ["src/main/java", "src/main/kotlin"]
        }
    }
    test {
        java {
            srcDirs = ["src/test/java", "src/test/kotlin"]
        }
    }
}

test {
    useJUnitPlatform()
    testLogging {
        events("passed", "skipped", "failed")
    }
}

jar {
    manifest {
//        attributes(new HashMap<String, Object>('Main-Class': mainClassName))
    }
    from {
        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

//tasks.withType<KotlinCompile> {
//    kotlinOptions {
//        freeCompilerArgs = listOf("-Xjsr305=strict")
//        jvmTarget = "1.9"
//    }
//}

ext {
    lombok_v = "1.18.12"
}


java.sourceCompatibility = JavaVersion.VERSION_1_9
java.targetCompatibility = JavaVersion.VERSION_1_9

dependencies {

    compile(
            "org.mybatis:mybatis:3.5.3",
            "io.projectreactor:reactor-core:+",
//            "javax.annotation:jsr250-api:1.0"
            'org.hashids:hashids:1.0.1',
            'com.fasterxml.jackson.core:jackson-core:2.8.6',
            'com.fasterxml.jackson.core:jackson-annotations:2.8.6',
            'com.fasterxml.jackson.core:jackson-databind:2.8.6',
    )
    compile group: 'com.alibaba', name: 'fastjson', version: '1.2.66'
    compile group: 'redis.clients', name: 'jedis', version: '3.0.1'

    compileOnly "org.projectlombok:lombok:$lombok_v"
    annotationProcessor "org.projectlombok:lombok:$lombok_v"

//    apt "org.projectlombok:lombok:$lombok_v"
//    implementation "org.projectlombok:lombok:$lombok_v"
    compile(platform("org.jetbrains.kotlin:kotlin-bom:+"))
    compile("org.jetbrains.kotlin:kotlin-stdlib-jdk8:+")

    runtime(
            'org.postgresql:postgresql:42.2.9', // pg的驱动
    )

    //    implementation 'com.google.guava:guava:28.0-jre'


//    testImplementation 'org.codehaus.groovy:groovy-all:2.5.8'
//    testCompile (
//            "io.projectreactor:reactor-test:+"
//    )
//    testCompileOnly "org.projectlombok:lombok:$lombok_v"
//    testAnnotationProcessor "org.projectlombok:lombok:$lombok_v"
//    testImplementation 'org.spockframework:spock-core:1.3-groovy-2.5'
//    testImplementation 'junit:junit:4.12'
    testImplementation("org.junit.jupiter:junit-jupiter:5.6.0")
}

wrapper {
    version("6.0.1")
    distributionUrl("https://services.gradle.org/distributions/gradle-6.0.1-all.zip")
}





